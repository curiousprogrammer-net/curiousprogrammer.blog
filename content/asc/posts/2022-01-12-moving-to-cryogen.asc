{
:date "2022-01-16"
:title "Moving My Blog to Cryogen and Cloudflare Pages"
:layout :post
:tags  ["cryogen" "asciidoc" "cloudflare"]
:toc :ul
}

== The Wordpress problem

I wanted to migrate away from the existing Wordpress-based hosting for
https://curiousprogrammer.net[my curiosprogrammer.net blog]
for a long time yet I have not found time to do that until now.
Today, I'm finally moving towards much simpler approach using
https://github.com/cryogen-project/cryogen[Cryogen] as the underlying blog engine.

== Cryogen

https://cryogenweb.org/[Cryogen] is a simple blog engine written in Clojure.
It's used by a number of people in Clojure community, including https://github.com/seancorfield/seancorfield.github.io[Sean Corfield] and https://blog.jakubholy.net/2019/migrating-from-gatsby-to-cryogen/[Jakub Holy].

I think it will well serve my needs
and I hope that the friction for publishing posts
(and the frustrations caused by Wordpress editor)
is going to diminish.

=== AsciiDoc

I've found a couple of AsciiDoc-related links in
https://blog.jakubholy.net/2019/migrating-from-gatsby-to-cryogen/[Jakub Holy's article]
and decided to give it a try.
The promise is that, unlike Markdown, it's standardized, extensible and has richer formatting options.

Check the https://raw.githubusercontent.com/curiousprogrammer-net/curiousprogrammer.blog/blog-redirects/content/asc/posts/2022-01-12-moving-to-cryogen.asc[AsciiDoc source of this blog post]

See:

- https://www.ericholscher.com/blog/2016/mar/15/dont-use-markdown-for-technical-docs/[Why You Shouldn’t Use “Markdown” for Documentation]
- https://docs.asciidoctor.org/asciidoc/latest/asciidoc-vs-markdown/[Compare AsciiDoc to Markdown]
- https://docs.asciidoctor.org/asciidoc/latest/syntax-quick-reference/[AsciiDoc Syntax Quick Reference]


== Cloudflare pages

I was looking for a simple, free/cheap, robutst, and still powerful-enough static site hosting.

I considered GitHub Pages but they are rather crude and don't offer much options.
In particular, I wanted to configure redirects for my old curiousprogrammer.net blog posts.

I finally found https://pages.cloudflare.com/[Cloudflare Pages] and didn't look further
I already had a Cloudflare account because I've been using Cloudflare for a few of my domains
so it was really quick to set it up and have a dev version of the blog up running.

If you are interested,
check their https://developers.cloudflare.com/pages/get-started[Get Started docs page].


== The old blog/content

I moved the old posts (including most of the tags!) and pages from my old wordpress blog to the new structure.
The steps were roughly:

. https://kevq.uk/how-to-convert-wordpress-to-markdown/[Convert WordPress To Markdown]
. https://matthewsetter.com/technical-documentation/asciidoc/convert-markdown-to-asciidoc-with-kramdoc/[Convert Markdown to AsciiDoc The Right Way! Use Kramdoc]
+
[source,bash]
----
find . -name "*.md" -type f -exec sh -c 'kramdoc --format=GFM --wrap=ventilate --output={}.adoc {}' \;

cp -r YOUR_DIR content/old-posts-converted
# rename the files and move them to the proper directory
cd content/old-posts-converted
find . -name "*.adoc" -exec sh -c 'postname=$(realpath --relative-to=. {}| sed "s@/index.md@@"); cp {} "$postname"' \;
----
. Go through the files manually - fix formatting, tags, etc.
. Configure redirects with Cloudflare Pages (`_redirects` file) https://developers.cloudflare.com/pages/platform/redirects
. Add pages manually (not covered by the conversation process above)



